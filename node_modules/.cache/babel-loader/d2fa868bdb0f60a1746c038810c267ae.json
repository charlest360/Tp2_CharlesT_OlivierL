{"remainingRequest":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\carlo\\Documents\\TP2\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\carlo\\Documents\\TP2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\carlo\\Documents\\TP2\\src\\components\\addCritic.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\carlo\\Documents\\TP2\\src\\components\\addCritic.vue","mtime":1590079804766},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgU3RhclJhdGluZyBmcm9tICd2dWUtc3Rhci1yYXRpbmcnOwppbXBvcnQgRmlsbVNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlcy9GaWxtU2VydmljZS5qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBTdGFyUmF0aW5nOiBTdGFyUmF0aW5nCiAgfSwKICBwcm9wczogewogICAgZmlsbUlkOiB7CiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcmF0aW5nOiAwLAogICAgICBjb21tZW50OiAnJywKICAgICAgcmVzcG9uc2U6IG51bGwsCiAgICAgIGVycm9yOiBudWxsLAogICAgICB2YWxpZGF0aW9uRXJyb3JzOiBbXSwKICAgICAgZmlsbUNyaXRpY3M6IG51bGwsCiAgICAgIGhhc0NyaXRpYzogZmFsc2UsCiAgICAgIGNyaXRpY0lkOiBudWxsCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TW92aWVSZXZpZXdzKCk7CiAgfSwKICB3YXRjaDogewogICAgZmlsbUNyaXRpY3M6IGZ1bmN0aW9uIGZpbG1Dcml0aWNzKCkgewogICAgICBpZiAodGhpcy5maWxtQ3JpdGljcyAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5jaGVja0lmVXNlckhhc0NyaXRpYygpOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB2YWxpZGF0ZUFuZFNlbmQ6IGZ1bmN0aW9uIHZhbGlkYXRlQW5kU2VuZCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuZXJyb3IgPSBudWxsOwoKICAgICAgaWYgKHRoaXMudmFsaWRhdGVEYXRhKCkgPT0gdHJ1ZSkgewogICAgICAgIHZhciBkYXRhID0gewogICAgICAgICAgdXNlcl9pZDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJfaWQnKSwKICAgICAgICAgIGZpbG1faWQ6IHRoaXMuZmlsbUlkLAogICAgICAgICAgc2NvcmU6IHRoaXMucmF0aW5nLAogICAgICAgICAgY29tbWVudDogdGhpcy5jb21tZW50CiAgICAgICAgfTsKCiAgICAgICAgaWYgKHRoaXMuaGFzQ3JpdGljID09IHRydWUpIHsKICAgICAgICAgIGRhdGEuY3JpdGljSWQgPSB0aGlzLmNyaXRpY0lkOwogICAgICAgICAgRmlsbVNlcnZpY2UuZWRpdENyaXRpYyhkYXRhLCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXMucmVzcG9uc2UgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRmlsbVNlcnZpY2UuYWRkQ3JpdGljKGRhdGEsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvcjsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHZhbGlkYXRlRGF0YTogZnVuY3Rpb24gdmFsaWRhdGVEYXRhKCkgewogICAgICB0aGlzLnZhbGlkYXRpb25FcnJvcnMgPSBbXTsKCiAgICAgIGlmICh0aGlzLmNvbW1lbnQgPT0gJycpIHsKICAgICAgICB0aGlzLnZhbGlkYXRpb25FcnJvcnMucHVzaCh7CiAgICAgICAgICB0eXBlOiAnY29tbWVudCcsCiAgICAgICAgICBtZXNzYWdlOiAnQ29tbWVudCBmaWVsZCBpcyByZXF1aXJlZC4nCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmNvbW1lbnQubGVuZ3RoID4gMjUwKSB7CiAgICAgICAgdGhpcy52YWxpZGF0aW9uRXJyb3JzLnB1c2goewogICAgICAgICAgdHlwZTogJ2NvbW1lbnQnLAogICAgICAgICAgbWVzc2FnZTogJ0NvbW1lbnQgZmllbGQgY2FuIGhvbGQgYSBtYXggb2YgMjUwIGNoYXJhY3RlcnMuJwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgZ2V0TW92aWVSZXZpZXdzOiBmdW5jdGlvbiBnZXRNb3ZpZVJldmlld3MoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgRmlsbVNlcnZpY2UuZ2V0RmlsbUJ5SWQodGhpcy5maWxtSWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMyLmZpbG1Dcml0aWNzID0gcmVzcG9uc2UuZGF0YS5jcml0aWM7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIF90aGlzMi5lcnJvciA9IGVycm9yOwogICAgICB9KTsKICAgICAgdGhpcy5jaGVja0lmVXNlckhhc0NyaXRpYygpOwogICAgfSwKICAgIGNoZWNrSWZVc2VySGFzQ3JpdGljOiBmdW5jdGlvbiBjaGVja0lmVXNlckhhc0NyaXRpYygpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpbG1Dcml0aWNzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMuZmlsbUNyaXRpY3NbaV0udXNlcl9pZC50b1N0cmluZygpID09IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyX2lkJykpIHsKICAgICAgICAgIHRoaXMucmF0aW5nID0gcGFyc2VGbG9hdCh0aGlzLmZpbG1Dcml0aWNzW2ldLnNjb3JlKTsKICAgICAgICAgIHRoaXMuY29tbWVudCA9IHRoaXMuZmlsbUNyaXRpY3NbaV0uY29tbWVudDsKICAgICAgICAgIHRoaXMuaGFzQ3JpdGljID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuY3JpdGljSWQgPSB0aGlzLmZpbG1Dcml0aWNzW2ldLmlkOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["addCritic.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    \r\n    <div class=\"reviewForm\">\r\n        <div v-if=\"error != null\">\r\n            <span v-if=\"hasCritic == true\" style=\"color:red;font-size:25px;\" > Failed to edit the review</span>\r\n            <span v-if=\"hasCritic == false\" style=\"color:red;font-size:25px;\" > Failed to add the review</span>\r\n        </div>\r\n        <div v-if=\"response != null\">\r\n            <span v-if=\"hasCritic == true\" style=\"color:green;font-size:35px;\">Review edited with success</span>\r\n            <span v-if=\"hasCritic == false\" style=\"color:green;font-size:35px;\"> Review added with success </span>\r\n        </div>\r\n        <div v-else>\r\n             <h2>My Review :</h2>\r\n        \r\n         <form @submit.prevent=\"validateAndSend\" >\r\n            <div class='ratingDiv'>\r\n                <span > Ranking : </span>\r\n                <star-rating id=\"rating\"\r\n                    v-model=\"rating\"           \r\n                    v-bind:increment=\"0.5\"\r\n                    v-bind:max-rating=\"5\"\r\n                    inactive-color=\"#dbdbdb\"\r\n                    active-color=\"#cc1166\"\r\n                    v-bind:star-size=\"20\"\r\n                    border-color=\"fcdc6d\"\r\n                /> \r\n            </div>\r\n             \r\n            <div class=\"commentDiv\">\r\n                <textarea  v-model=\"comment\"   id=\"commentInput\" rows=\"4\" cols=\"50 \" placeholder=\"Comment your review\"/>\r\n                \r\n            </div>\r\n            <div v-if=\"validationErrors.length >= 1 && validationErrors[0].type == 'comment' \"> \r\n                    <span style=\"color:red;\">{{validationErrors[0].message}} </span>\r\n            </div>\r\n             <button v-if=\"hasCritic == true\"  id=\"submitButton\" >\r\n                        Edit Review\r\n            </button>\r\n             <button v-if=\"hasCritic == false\"  id=\"submitButton\" >\r\n                        Add Review\r\n            </button>\r\n        </form>\r\n        </div>\r\n       \r\n        \r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import StarRating from 'vue-star-rating';\r\n    import FilmService from '@/services/FilmService.js';\r\n    export default {\r\n        components: {\r\n            StarRating,\r\n        },\r\n        props: {\r\n            filmId: {\r\n                default: null,\r\n                required: true\r\n            },\r\n        },\r\n        data() {\r\n            return {\r\n                rating: 0,\r\n                comment: '',\r\n                response: null,\r\n                error: null,\r\n                validationErrors: [],\r\n                filmCritics : null,\r\n                hasCritic : false,\r\n                criticId : null,\r\n            }\r\n        },\r\n        created () {\r\n            this.getMovieReviews();\r\n        },\r\n        watch: {\r\n            filmCritics: function() {\r\n                if(this.filmCritics != null) {\r\n                    this.checkIfUserHasCritic();\r\n                }\r\n            },\r\n        },\r\n        methods: {\r\n            validateAndSend() {\r\n                this.error = null;\r\n                if(this.validateData() == true){\r\n                    let data = {\r\n                        user_id : localStorage.getItem('user_id'),\r\n                        film_id : this.filmId,\r\n                        score : this.rating,\r\n                        comment : this.comment,\r\n                        \r\n                    }\r\n                    if(this.hasCritic ==true){\r\n                        data.criticId = this.criticId;\r\n                        FilmService.editCritic(data,localStorage.getItem('token'))\r\n                        .then(response => {\r\n                        this.response = response.data;\r\n                        })\r\n                        .catch(error => {\r\n                        this.error = error;\r\n                        });\r\n                        \r\n                    }\r\n                    else{\r\n                        FilmService.addCritic(data,localStorage.getItem('token'))\r\n                        .then(response => {\r\n                        this.response = response.data;\r\n                        })\r\n                        .catch(error => {\r\n                        this.error = error;\r\n                        });\r\n                        }\r\n                    \r\n                }\r\n            },\r\n            validateData(){\r\n                this.validationErrors = [];\r\n                if(this.comment == ''){\r\n                    this.validationErrors.push({type:'comment',message:'Comment field is required.'});\r\n                }\r\n                if(this.comment.length > 250){\r\n                    this.validationErrors.push({type:'comment',message:'Comment field can hold a max of 250 characters.'});\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            getMovieReviews() {\r\n                FilmService.getFilmById(this.filmId)\r\n                .then(response => {\r\n                this.filmCritics = response.data.critic;\r\n                })\r\n                .catch(error => {\r\n                this.error = error;\r\n                })\r\n                this.checkIfUserHasCritic();\r\n            },\r\n            checkIfUserHasCritic(){\r\n                for(let i =0;i < this.filmCritics.length;i++){\r\n                    if(this.filmCritics[i].user_id.toString() == localStorage.getItem('user_id')){\r\n                        this.rating = parseFloat(this.filmCritics[i].score);\r\n                        this.comment = this.filmCritics[i].comment;    \r\n                        this.hasCritic = true;\r\n                        this.criticId = this.filmCritics[i].id;\r\n                        break;     \r\n                }\r\n                \r\n            }\r\n        \r\n        },\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.ratingDiv{\r\n    margin-left: 10%;\r\n    \r\n    text-align: left;\r\n    font-size:20px;\r\n}\r\n.commentDiv{\r\n    margin-left: 10%;\r\n    margin-right: 10%;\r\n    text-align: center;\r\n    font-size:20px;\r\n}\r\n.reviewForm{\r\n    \r\n    padding-top: 10px;\r\n    padding-bottom :40px;\r\n    text-align: center;\r\n    margin: auto;\r\n    width:60%;\r\n    background-color: #fcdc6d;\r\n    border: 1px solid black;\r\n    margin-top:20px;\r\n}\r\n#commentInput{\r\n    width: 100%;\r\n}\r\n#rating{\r\n    margin: auto;\r\n    display: inline-block;\r\n}\r\n    #submitButton {\r\n        margin-top: 20px ;\r\n        width: 50%;\r\n        font-size: 20px;\r\n        padding-top: 10px;\r\n        padding-bottom: 10px;\r\n        font-weight: bold;\r\n        color: #E6B91E;\r\n        background-color: black;\r\n        \r\n    }\r\n    .hidden {\r\n        display: none;\r\n    }\r\n    .error {\r\n        float: left;\r\n    }\r\n   \r\n</style>"],"sourceRoot":"src/components"}]}