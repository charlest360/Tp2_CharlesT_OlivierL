{"remainingRequest":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\carlo\\Documents\\TP2\\src\\components\\addCritic.vue?vue&type=style&index=0&id=7123e615&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\carlo\\Documents\\TP2\\src\\components\\addCritic.vue","mtime":1590087788937},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\carlo\\Documents\\TP2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KDQoucmF0aW5nRGl2ew0KICAgIG1hcmdpbi1sZWZ0OiAxMCU7DQogICAgDQogICAgdGV4dC1hbGlnbjogbGVmdDsNCiAgICBmb250LXNpemU6MjBweDsNCn0NCi5jb21tZW50RGl2ew0KICAgIG1hcmdpbi1sZWZ0OiAxMCU7DQogICAgbWFyZ2luLXJpZ2h0OiAxMCU7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZToyMHB4Ow0KfQ0KLnJldmlld0Zvcm17DQogICAgcGFkZGluZy10b3A6IDEwcHg7DQogICAgcGFkZGluZy1ib3R0b20gOjQwcHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIG1hcmdpbjogYXV0bzsNCiAgICB3aWR0aDo2MCU7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZjZGM2ZDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjazsNCiAgICBtYXJnaW4tdG9wOjIwcHg7DQp9DQojY29tbWVudElucHV0ew0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KI3JhdGluZ3sNCiAgICBtYXJnaW46IGF1dG87DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KfQ0KI3N1Ym1pdEJ1dHRvbiB7DQogICAgbWFyZ2luLXRvcDogMjBweCA7DQogICAgd2lkdGg6IDUwJTsNCiAgICBmb250LXNpemU6IDIwcHg7DQogICAgcGFkZGluZy10b3A6IDEwcHg7DQogICAgcGFkZGluZy1ib3R0b206IDEwcHg7DQogICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgY29sb3I6ICNFNkI5MUU7DQogICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7ICAgDQp9DQouaGlkZGVuIHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KLmVycm9yIHsNCiAgICBjb2xvcjogcmVkOw0KICAgIGZvbnQtc2l6ZTogMzVweDsNCn0NCi5yZXNwb25zZXsNCiAgICBjb2xvcjpncmVlbjsNCiAgICBmb250LXNpemU6IDM1cHg7DQp9DQoudmFsaWRhdGlvbkVycm9yew0KICAgIGNvbG9yOiByZWQ7DQp9DQogICANCg=="},{"version":3,"sources":["addCritic.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyJA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addCritic.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    \r\n    <div class=\"reviewForm\">\r\n        <div v-if=\"error != null\">\r\n            <span class=\"error\" v-if=\"hasCritic == true\"  > Failed to edit the review</span>\r\n            <span class=\"error\" v-if=\"hasCritic == false\"  > Failed to add the review</span>\r\n        </div>\r\n        <div v-else-if=\"response != null\">\r\n            <span class=\"response\" v-if=\"hasCritic == true\" >Review edited with success</span>\r\n            <span class=\"response\" v-if=\"hasCritic == false\" > Review added with success </span>\r\n        </div>\r\n        <div v-else>\r\n             <h2>My Review :</h2>\r\n        \r\n            <form @submit.prevent=\"validateAndSend\" >\r\n                <div class='ratingDiv'>\r\n                    <span > Ranking : </span>\r\n                    <star-rating id=\"rating\"\r\n                        v-model=\"rating\"           \r\n                        v-bind:increment=\"0.5\"\r\n                        v-bind:max-rating=\"5\"\r\n                        inactive-color=\"#dbdbdb\"\r\n                        active-color=\"#cc1166\"\r\n                        v-bind:star-size=\"20\"\r\n                        border-color=\"fcdc6d\"\r\n                    /> \r\n                </div>\r\n             \r\n                <div class=\"commentDiv\">\r\n                    <textarea  v-model=\"comment\"   id=\"commentInput\" rows=\"4\" cols=\"50 \" placeholder=\"Comment your review\"/>\r\n                \r\n                </div>\r\n                <div v-if=\"validationErrors.length >= 1 && validationErrors[0].type == 'comment' \"> \r\n                    <span class=\"validationError\">{{validationErrors[0].message}} </span>\r\n                </div>\r\n                <button v-if=\"hasCritic == true\"  id=\"submitButton\" >\r\n                    Edit Review\r\n                </button>\r\n                <button v-if=\"hasCritic == false\"  id=\"submitButton\" >\r\n                        Add Review\r\n                </button>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import StarRating from 'vue-star-rating';\r\n    import FilmService from '@/services/FilmService.js';\r\n    export default {\r\n        components: {\r\n            StarRating,\r\n        },\r\n        props: {\r\n            filmId: {\r\n                default: null,\r\n                required: true\r\n            },\r\n        },\r\n        data() {\r\n            return {\r\n                rating: 0,\r\n                comment: '',\r\n                response: null,\r\n                error: null,\r\n                validationErrors: [],\r\n                filmCritics : null,\r\n                hasCritic : false,\r\n                criticId : null,\r\n            }\r\n        },\r\n        created () {\r\n            this.getMovieReviews();\r\n        },\r\n        watch: {\r\n            filmCritics: function() {\r\n                if(this.filmCritics != null) {\r\n                    this.checkIfUserHasCritic();\r\n                }\r\n            },\r\n        },\r\n        methods: {\r\n            validateAndSend() {\r\n                this.error = null;\r\n                if(this.validateData() == true){\r\n                    let data = {\r\n                        user_id : localStorage.getItem('user_id'),\r\n                        film_id : this.filmId,\r\n                        score : this.rating,\r\n                        comment : this.comment,\r\n                        \r\n                    }\r\n                    if(this.hasCritic ==true){\r\n                        data.criticId = this.criticId;\r\n                        FilmService.editCritic(data,localStorage.getItem('token'))\r\n                        .then(response => {\r\n                        this.response = response.data;\r\n                        })\r\n                        .catch(error => {\r\n                        this.error = error;\r\n                        }); \r\n                    }\r\n                    else{\r\n                        FilmService.addCritic(data,localStorage.getItem('token'))\r\n                        .then(response => {\r\n                        this.response = response.data;\r\n                        })\r\n                        .catch(error => {\r\n                        this.error = error;\r\n                        });\r\n                    }\r\n                    \r\n                }\r\n            },\r\n            validateData(){\r\n                this.validationErrors = [];\r\n                if(this.comment == ''){\r\n                    this.validationErrors.push({type:'comment',message:'Comment field is required.'});\r\n                    return false;\r\n                }\r\n                if(this.comment.length > 250){\r\n                    this.validationErrors.push({type:'comment',message:'Comment field can hold a max of 250 characters.'});\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            getMovieReviews() {\r\n                FilmService.getFilmById(this.filmId)\r\n                .then(response => {\r\n                this.filmCritics = response.data.critic;\r\n                })\r\n                .catch(error => {\r\n                this.error = error;\r\n                })\r\n                this.checkIfUserHasCritic();\r\n            },\r\n            checkIfUserHasCritic(){\r\n                for(let i =0;i < this.filmCritics.length;i++){\r\n                    if(this.filmCritics[i].user_id.toString() == localStorage.getItem('user_id')){\r\n                        this.rating = parseFloat(this.filmCritics[i].score);\r\n                        this.comment = this.filmCritics[i].comment;    \r\n                        this.hasCritic = true;\r\n                        this.criticId = this.filmCritics[i].id;\r\n                        break;     \r\n                    }     \r\n                }\r\n            },\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.ratingDiv{\r\n    margin-left: 10%;\r\n    \r\n    text-align: left;\r\n    font-size:20px;\r\n}\r\n.commentDiv{\r\n    margin-left: 10%;\r\n    margin-right: 10%;\r\n    text-align: center;\r\n    font-size:20px;\r\n}\r\n.reviewForm{\r\n    padding-top: 10px;\r\n    padding-bottom :40px;\r\n    text-align: center;\r\n    margin: auto;\r\n    width:60%;\r\n    background-color: #fcdc6d;\r\n    border: 1px solid black;\r\n    margin-top:20px;\r\n}\r\n#commentInput{\r\n    width: 100%;\r\n}\r\n#rating{\r\n    margin: auto;\r\n    display: inline-block;\r\n}\r\n#submitButton {\r\n    margin-top: 20px ;\r\n    width: 50%;\r\n    font-size: 20px;\r\n    padding-top: 10px;\r\n    padding-bottom: 10px;\r\n    font-weight: bold;\r\n    color: #E6B91E;\r\n    background-color: black;   \r\n}\r\n.hidden {\r\n    display: none;\r\n}\r\n.error {\r\n    color: red;\r\n    font-size: 35px;\r\n}\r\n.response{\r\n    color:green;\r\n    font-size: 35px;\r\n}\r\n.validationError{\r\n    color: red;\r\n}\r\n   \r\n</style>"]}]}